# Test wheel resolution from environment variables
#
# This test verifies that COG_WHEEL and COGLET_WHEEL environment variables
# correctly resolve wheel paths, including:
# - Absolute directory paths resolve and find wheels inside
# - Relative paths resolved to absolute
# - Clear errors when wheel not found

# Test 1: COG_WHEEL pointing to repo dist/ directory finds wheel
env COG_WHEEL=${REPO_ROOT}/dist
cog build -t $TEST_IMAGE
stderr 'Using local cog wheel:'

# Test 2: Relative path that doesn't exist gives clear error  
env COG_WHEEL=./nonexistent/wheel.whl
! cog build -t $TEST_IMAGE
stderr 'path not found'

-- cog.yaml --
build:
  python_version: "3.12"
predict: "predict.py:Predictor"

-- predict.py --
from cog import BasePredictor

class Predictor(BasePredictor):
    def predict(self, s: str) -> str:
        return "hello " + s
