# Test iterator prediction with Path outputs (no upload URL â€” files written to disk)

cog build -t $TEST_IMAGE
cog run $TEST_IMAGE

# cog run writes file outputs to disk, not as base64 to stdout
stderr 'Written output to: output.0.png'
stderr 'Written output to: output.1.png'
stderr 'Written output to: output.2.png'
! stderr 'failed'

-- cog.yaml --
build:
  python_version: "3.12"
  python_packages:
    - "pillow==10.4.0"
run: "run.py:Runner"

-- run.py --
import os
import tempfile
from typing import Iterator

from cog import BaseRunner, Path
from PIL import Image


class Runner(BaseRunner):
    def run(self) -> Iterator[Path]:
        for color in ["red", "blue", "green"]:
            d = tempfile.mkdtemp()
            p = os.path.join(d, f"{color}.png")
            Image.new("RGB", (10, 10), color).save(p)
            yield Path(p)
