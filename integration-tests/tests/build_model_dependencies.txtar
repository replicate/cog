# Skip for coglet_alpha which does not support this
[coglet_alpha] skip

# Test r8_model_dependencies label for pipeline dependencies
# Source: test_build.py::test_model_dependencies

# Build the image with pipeline dependencies
cog build -t $TEST_IMAGE

# Check the r8_model_dependencies label contains the expected dependency
exec docker inspect $TEST_IMAGE --format '{{index .Config.Labels "run.cog.r8_model_dependencies"}}'
stdout 'pipelines-beta/upcase'

-- cog.yaml --
build:
  python_version: "3.13"
predict: "predict.py:run"

-- predict.py --
from cog import Input
from replicate import use

upcase = use("pipelines-beta/upcase")


def run(
    prompt: str = Input(),
) -> str:
    upcased_prompt = upcase(prompt=prompt)
    return f"HELLO {upcased_prompt}"
